<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NOVAI - R√©sultats du Quiz</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="logo-section">
                <div class="logo">
                    <img src="logo.png" alt="NOVAI Logo" class="logo-image">
                </div>
            </div>

            <nav class="nav-menu">
                <a href="/journey.html" class="nav-item-link">
                    <div class="nav-item">
                        <div class="nav-icon">üè†</div>
                        <div class="nav-label">Accueil</div>
                    </div>
                </a>
                <div class="nav-dropdown">
                    <div class="nav-item-link nav-dropdown-trigger" onclick="toggleNavDropdown(event)">
                        <div class="nav-item">
                            <div class="nav-icon">üë§</div>
                            <div class="nav-label">MOI</div>
                            <div class="nav-dropdown-arrow">‚ñº</div>
                        </div>
                    </div>
                    <div class="nav-dropdown-menu">
                        <a href="/profil.html" class="nav-dropdown-item">
                            <div class="dropdown-icon">üìã</div>
                            <div class="dropdown-label">Mon Profil</div>
                        </a>
                        <a href="/gouts.html" class="nav-dropdown-item">
                            <div class="dropdown-icon">‚ù§Ô∏è</div>
                            <div class="dropdown-label">Mes Go√ªts</div>
                        </a>
                        <a href="/capacites.html" class="nav-dropdown-item">
                            <div class="dropdown-icon">üß†</div>
                            <div class="dropdown-label">Mes Capacit√©s</div>
                        </a>
                        <a href="/personality-journey.html" class="nav-dropdown-item">
                            <div class="dropdown-icon">‚ú®</div>
                            <div class="dropdown-label">Test de Personnalit√©</div>
                        </a>
                    </div>
                </div>
                <a href="/quiz.html" class="nav-item-link">
                    <div class="nav-item active">
                        <div class="nav-icon">üéØ</div>
                        <div class="nav-label">Quiz & Tests</div>
                    </div>
                </a>
                <a href="/secteurs.html" class="nav-item-link">
                    <div class="nav-item">
                        <div class="nav-icon">üåê</div>
                        <div class="nav-label">D√©couverte de secteurs</div>
                    </div>
                </a>
                <a href="/events.html" class="nav-item-link">
                    <div class="nav-item">
                        <div class="nav-icon">üìÖ</div>
                        <div class="nav-label">Mes √âv√©nements</div>
                    </div>
                </a>
                <a href="/entreprises.html" class="nav-item-link">
                    <div class="nav-item">
                        <div class="nav-icon">üè¢</div>
                        <div class="nav-label">Approfondir le monde du travail</div>
                    </div>
                </a>
            </nav>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Header -->
            <div class="header">
                <div class="header-left">
                    <a href="/logout.html" class="header-icon-btn logout-btn" title="D√©connexion">
                        D√©connexion
                    </a>
                </div>

                <div class="header-center">
                    <div class="progress-blocks">
                        <a href="/personality-journey.html" class="progress-block active" style="text-decoration: none; color: inherit;">
                            <span class="block-number">1</span>
                            <span class="block-label">Te connaitre</span>
                        </a>
                        <a href="/quiz.html" class="progress-block active" style="text-decoration: none; color: inherit;">
                            <span class="block-number">2</span>
                            <span class="block-label">Te tester</span>
                        </a>
                        <a href="/secteurs.html" class="progress-block" style="text-decoration: none; color: inherit;">
                            <span class="block-number">3</span>
                            <span class="block-label">D√©couverte</span>
                        </a>
                        <a href="/events.html" class="progress-block" style="text-decoration: none; color: inherit;">
                            <span class="block-number">4</span>
                            <span class="block-label">Ev√©nements</span>
                        </a>
                        <a href="/entreprises.html" class="progress-block" style="text-decoration: none; color: inherit;">
                            <span class="block-number">5</span>
                            <span class="block-label">Approf.</span>
                        </a>
                    </div>
                </div>

                <div class="header-right">
                    <div class="header-icon-btn" id="settingsBtn">
                        ‚öôÔ∏è
                        <div class="settings-dropdown" id="settingsDropdown">
                            <div class="dropdown-item">Style du site</div>
                            <div class="dropdown-item">Support</div>
                            <div class="dropdown-item">Abonnement</div>
                            <div class="dropdown-item">Nos partenaires</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Content Area -->
            <div class="content-area">
                <!-- Results Container -->
                <div class="quiz-results-page">
                    <div class="results-header">
                        <div class="results-icon-large">üéâ</div>
                        <h1>Quiz termin√© !</h1>
                        <p class="results-subtitle">Bravo, tu as compl√©t√© le quiz</p>
                    </div>

                    <div class="results-main-card">
                        <div class="score-display">
                            <div class="score-circle-large">
                                <div class="score-content">
                                    <span class="score-number-large" id="scoreNumber">0</span>
                                    <span class="score-separator">/</span>
                                    <span class="score-total-large" id="scoreTotal">10</span>
                                </div>
                            </div>
                        </div>

                        <div class="score-details">
                            <h2 class="score-title">Score global</h2>
                            <div class="percentage-badge" id="percentageBadge">0%</div>
                            <p class="score-message" id="scoreMessage">Excellent travail !</p>
                        </div>

                        <div class="results-stats">
                            <div class="stat-item">
                                <div class="stat-icon">‚úÖ</div>
                                <div class="stat-label">Bonnes r√©ponses</div>
                                <div class="stat-value" id="correctAnswers">0</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-icon">‚ùå</div>
                                <div class="stat-label">Mauvaises r√©ponses</div>
                                <div class="stat-value" id="wrongAnswers">0</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-icon">‚è±Ô∏è</div>
                                <div class="stat-label">Temps √©coul√©</div>
                                <div class="stat-value" id="timeSpent">10 min</div>
                            </div>
                        </div>
                    </div>

                    <div class="results-actions">
                        <button class="btn-primary-large" onclick="window.location.href='/quiz.html'">
                            üéØ Faire un nouveau quiz
                        </button>
                        <button class="btn-secondary-large" id="restartQuizBtn">
                            üîÑ Recommencer ce quiz
                        </button>
                        <button class="btn-tertiary" onclick="window.location.href='/journey.html'">
                            üè† Retour √† l'accueil
                        </button>
                    </div>

                    <div class="results-encouragement">
                        <div class="encouragement-card">
                            <h3>Continue ton parcours !</h3>
                            <p>Tu as fait un excellent travail. Continue √† explorer les diff√©rents quiz pour mieux te conna√Ætre et d√©couvrir tes talents.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Get score from URL parameters or sessionStorage
        function getQuizResults() {
            const urlParams = new URLSearchParams(window.location.search);
            const score = urlParams.get('score') || sessionStorage.getItem('quizScore') || 0;
            const total = urlParams.get('total') || sessionStorage.getItem('quizTotal') || 10;
            const type = urlParams.get('type') || sessionStorage.getItem('quizType') || 'personnalite';
            
            return {
                score: parseInt(score),
                total: parseInt(total),
                type: type
            };
        }

        // Display results
        function displayResults() {
            const results = getQuizResults();
            const percentage = Math.round((results.score / results.total) * 100);
            
            // Update score display
            document.getElementById('scoreNumber').textContent = results.score;
            document.getElementById('scoreTotal').textContent = results.total;
            document.getElementById('percentageBadge').textContent = percentage + '%';
            
            // Update stats
            document.getElementById('correctAnswers').textContent = results.score;
            document.getElementById('wrongAnswers').textContent = results.total - results.score;
            
            // Update message based on percentage
            let message = '';
            const percentageBadge = document.getElementById('percentageBadge');
            
            if (percentage >= 90) {
                message = 'üéâ Exceptionnel ! Tu ma√Ætrises parfaitement le sujet.';
                percentageBadge.style.background = 'linear-gradient(135deg, #24A148 0%, #1D8139 100%)';
            } else if (percentage >= 75) {
                message = 'üåü Excellent travail ! Tu as de tr√®s bonnes connaissances.';
                percentageBadge.style.background = 'linear-gradient(135deg, #4E5EF1 0%, #0F62FE 100%)';
            } else if (percentage >= 60) {
                message = 'üëç Bon r√©sultat ! Tu as de bonnes bases √† d√©velopper.';
                percentageBadge.style.background = 'linear-gradient(135deg, #0F62FE 0%, #4E5EF1 100%)';
            } else if (percentage >= 40) {
                message = 'üí™ Pas mal ! Continue √† apprendre et √† t\'am√©liorer.';
                percentageBadge.style.background = 'linear-gradient(135deg, #FF9500 0%, #FF6B00 100%)';
            } else {
                message = 'üìö Continue tes efforts ! Il y a encore des choses √† d√©couvrir.';
                percentageBadge.style.background = 'linear-gradient(135deg, #FF006B 0%, #E94389 100%)';
            }
            
            document.getElementById('scoreMessage').textContent = message;
            
            // Animate the score circle
            animateScore(results.score, results.total);
            
            // Setup restart button with correct quiz type
            setupRestartButton(results.type);
        }

        // Setup restart button
        function setupRestartButton(quizType) {
            const restartBtn = document.getElementById('restartQuizBtn');
            restartBtn.onclick = function() {
                window.location.href = '/quiz-page.html?type=' + quizType;
            };
        }

        // Animate score circle
        function animateScore(score, total) {
            const circle = document.querySelector('.score-circle-large');
            const percentage = (score / total) * 100;
            
            // Create circular progress background
            circle.style.background = `conic-gradient(
                #4E5EF1 0deg,
                #4E5EF1 ${percentage * 3.6}deg,
                #E0E0E0 ${percentage * 3.6}deg,
                #E0E0E0 360deg
            )`;
        }

        // Settings dropdown
        document.getElementById('settingsBtn').addEventListener('click', function(e) {
            e.stopPropagation();
            const dropdown = document.getElementById('settingsDropdown');
            dropdown.classList.toggle('show');
        });

        document.addEventListener('click', function() {
            const dropdown = document.getElementById('settingsDropdown');
            dropdown.classList.remove('show');
        });

        // Navigation dropdown
        function toggleNavDropdown(event) {
            event.preventDefault();
            event.stopPropagation();
            const trigger = event.currentTarget;
            const dropdown = trigger.parentElement;
            dropdown.classList.toggle('open');
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', displayResults);
    </script>
</body>
</html>
